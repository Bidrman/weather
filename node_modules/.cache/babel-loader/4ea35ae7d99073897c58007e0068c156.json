{"ast":null,"code":"import { fetchWeather } from '../features/FetchAPI/fetchWeather';\nimport { FETCH_START, FETCH_SUCCESS, FETCH_FAIL, UPDATE_CITY } from '../features/Weather/store/actions';\nexport const fetchForecastStart = store => next => async action => {\n  if (action.type === FETCH_START) {\n    next(action);\n\n    try {\n      const response = await fetchWeather(action.payload);\n      store.dispatch({\n        type: FETCH_SUCCESS,\n        payload: response\n      });\n    } catch (error) {\n      next({\n        type: FETCH_FAIL,\n        payload: error\n      });\n    }\n  } else {\n    return next(action);\n  }\n};\nexport const fetchForecastSuccess = store => next => async action => {\n  if (action.type === FETCH_SUCCESS) {\n    // opetovne volani\n    //console.log('AKCE FETCH SUCCESS', action)\n    setTimeout(() => {\n      store.dispatch({\n        type: FETCH_START,\n        payload: action.payload.city.name\n      });\n    }, 600000); //\n\n    const new_data = {\n      name: action.payload.city.name,\n      date: new Date(),\n      data: action.payload.list.filter((piece, index) => index <= 3)\n    };\n    const next_action = {\n      type: UPDATE_CITY,\n      payload: new_data\n    };\n    console.log('novy data', next_action);\n    return next(next_action);\n  }\n\n  return next(action);\n};\nexport const fetchForecastFail = store => next => async action => {\n  console.log(action);\n\n  if (action.type === FETCH_FAIL) {\n    alert('spojeni se serverem nebylo uspesne, nastala chyba: ' + action.payload);\n    return next(action);\n  }\n\n  return next(action);\n};","map":{"version":3,"sources":["C:/javascript/weather/src/middlewares/ForecastMiddleware.jsx"],"names":["fetchWeather","FETCH_START","FETCH_SUCCESS","FETCH_FAIL","UPDATE_CITY","fetchForecastStart","store","next","action","type","response","payload","dispatch","error","fetchForecastSuccess","setTimeout","city","name","new_data","date","Date","data","list","filter","piece","index","next_action","console","log","fetchForecastFail","alert"],"mappings":"AAAA,SAASA,YAAT,QAA6B,mCAA7B;AACA,SACEC,WADF,EAEEC,aAFF,EAGEC,UAHF,EAIEC,WAJF,QAKO,mCALP;AAOA,OAAO,MAAMC,kBAAkB,GAAIC,KAAD,IAAYC,IAAD,IAAU,MAAOC,MAAP,IAAkB;AACvE,MAAIA,MAAM,CAACC,IAAP,KAAgBR,WAApB,EAAiC;AAC/BM,IAAAA,IAAI,CAACC,MAAD,CAAJ;;AACA,QAAI;AACF,YAAME,QAAQ,GAAG,MAAMV,YAAY,CAACQ,MAAM,CAACG,OAAR,CAAnC;AACAL,MAAAA,KAAK,CAACM,QAAN,CAAe;AAAEH,QAAAA,IAAI,EAAEP,aAAR;AAAuBS,QAAAA,OAAO,EAAED;AAAhC,OAAf;AACD,KAHD,CAGE,OAAOG,KAAP,EAAc;AACdN,MAAAA,IAAI,CAAC;AAAEE,QAAAA,IAAI,EAAEN,UAAR;AAAoBQ,QAAAA,OAAO,EAAEE;AAA7B,OAAD,CAAJ;AACD;AACF,GARD,MAQO;AACL,WAAON,IAAI,CAACC,MAAD,CAAX;AACD;AACF,CAZM;AAcP,OAAO,MAAMM,oBAAoB,GAAIR,KAAD,IAAYC,IAAD,IAAU,MAAOC,MAAP,IAAkB;AACzE,MAAIA,MAAM,CAACC,IAAP,KAAgBP,aAApB,EAAmC;AACjC;AACA;AACAa,IAAAA,UAAU,CAAC,MAAM;AACfT,MAAAA,KAAK,CAACM,QAAN,CAAe;AAAEH,QAAAA,IAAI,EAAER,WAAR;AAAqBU,QAAAA,OAAO,EAAEH,MAAM,CAACG,OAAP,CAAeK,IAAf,CAAoBC;AAAlD,OAAf;AACD,KAFS,EAEP,MAFO,CAAV,CAHiC,CAMjC;;AACA,UAAMC,QAAQ,GAAG;AACfD,MAAAA,IAAI,EAAET,MAAM,CAACG,OAAP,CAAeK,IAAf,CAAoBC,IADX;AAEfE,MAAAA,IAAI,EAAE,IAAIC,IAAJ,EAFS;AAGfC,MAAAA,IAAI,EAAEb,MAAM,CAACG,OAAP,CAAeW,IAAf,CAAoBC,MAApB,CAA2B,CAACC,KAAD,EAAQC,KAAR,KAAkBA,KAAK,IAAI,CAAtD;AAHS,KAAjB;AAMA,UAAMC,WAAW,GAAG;AAAEjB,MAAAA,IAAI,EAAEL,WAAR;AAAqBO,MAAAA,OAAO,EAAEO;AAA9B,KAApB;AACAS,IAAAA,OAAO,CAACC,GAAR,CAAY,WAAZ,EAAyBF,WAAzB;AAEA,WAAOnB,IAAI,CAACmB,WAAD,CAAX;AACD;;AACD,SAAOnB,IAAI,CAACC,MAAD,CAAX;AACD,CApBM;AAsBP,OAAO,MAAMqB,iBAAiB,GAAIvB,KAAD,IAAYC,IAAD,IAAU,MAAOC,MAAP,IAAkB;AACtEmB,EAAAA,OAAO,CAACC,GAAR,CAAYpB,MAAZ;;AAEA,MAAIA,MAAM,CAACC,IAAP,KAAgBN,UAApB,EAAgC;AAC9B2B,IAAAA,KAAK,CACH,wDAAwDtB,MAAM,CAACG,OAD5D,CAAL;AAIA,WAAOJ,IAAI,CAACC,MAAD,CAAX;AACD;;AAED,SAAOD,IAAI,CAACC,MAAD,CAAX;AACD,CAZM","sourcesContent":["import { fetchWeather } from '../features/FetchAPI/fetchWeather'\r\nimport {\r\n  FETCH_START,\r\n  FETCH_SUCCESS,\r\n  FETCH_FAIL,\r\n  UPDATE_CITY,\r\n} from '../features/Weather/store/actions'\r\n\r\nexport const fetchForecastStart = (store) => (next) => async (action) => {\r\n  if (action.type === FETCH_START) {\r\n    next(action)\r\n    try {\r\n      const response = await fetchWeather(action.payload)\r\n      store.dispatch({ type: FETCH_SUCCESS, payload: response })\r\n    } catch (error) {\r\n      next({ type: FETCH_FAIL, payload: error })\r\n    }\r\n  } else {\r\n    return next(action)\r\n  }\r\n}\r\n\r\nexport const fetchForecastSuccess = (store) => (next) => async (action) => {\r\n  if (action.type === FETCH_SUCCESS) {\r\n    // opetovne volani\r\n    //console.log('AKCE FETCH SUCCESS', action)\r\n    setTimeout(() => {\r\n      store.dispatch({ type: FETCH_START, payload: action.payload.city.name })\r\n    }, 600000)\r\n    //\r\n    const new_data = {\r\n      name: action.payload.city.name,\r\n      date: new Date(),\r\n      data: action.payload.list.filter((piece, index) => index <= 3),\r\n    }\r\n\r\n    const next_action = { type: UPDATE_CITY, payload: new_data }\r\n    console.log('novy data', next_action)\r\n\r\n    return next(next_action)\r\n  }\r\n  return next(action)\r\n}\r\n\r\nexport const fetchForecastFail = (store) => (next) => async (action) => {\r\n  console.log(action)\r\n\r\n  if (action.type === FETCH_FAIL) {\r\n    alert(\r\n      'spojeni se serverem nebylo uspesne, nastala chyba: ' + action.payload,\r\n    )\r\n\r\n    return next(action)\r\n  }\r\n\r\n  return next(action)\r\n}\r\n"]},"metadata":{},"sourceType":"module"}